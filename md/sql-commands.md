<< [На главную](../README.md)

# SQL : Основные команды

[DB Fiddle](https://www.db-fiddle.com/)<br>
Онлайн-песочница для выполнения SQL-запросов.

---

Навигация:

- [SQL : Основные команды](#sql--основные-команды)
  - [Создание базы данных](#создание-базы-данных)
    - [Первичный ключ](#первичный-ключ)
    - [Автогенерация первичного ключа](#автогенерация-первичного-ключа)
  - [Создание таблицы](#создание-таблицы)
  - [Добавление записи](#добавление-записи)
  - [Редактирование записи](#редактирование-записи)
  - [Получение данных](#получение-данных)
  - [Удаление записи](#удаление-записи)

---

### Создание базы данных

```sql
CREATE DATABASE db_name;
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-createtable.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-createdatabase)

---

### Создание таблицы

```sql
CREATE TABLE users (
    id BIGINT PRIMARY KEY GENERATED ALWAYS AS IDENTITY,
    username VARCHAR(50),
    email VARCHAR(255),
    birthday DATE,
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-createtable.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-createtable)

Хорошей практикой считается добавление и заполнение полей `created_at` и `updated_at` в каждую таблицу базы данных. С их помощью всегда можно узнать, когда запись создалась и обновилась.

- [Типы данных](./sql-types.md)

#### Первичный ключ

```sql
PRIMARY KEY
```

Первичный ключ однозначно идентифицирует каждую запись внутри таблицы. Задается с помощью фразы PRIMARY KEY, которая добавляется после указания типа, когда создается таблица. Первичный ключ в таблице может быть только один, и для него используется отдельное поле — идентификатор

> - [Documentation](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-PARMS-PRIMARY-KEY)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-createtable#SQL-CREATETABLE-PARMS-PRIMARY-KEY)

#### Автогенерация первичного ключа

```sql
GENERATED { ALWAYS | BY DEFAULT } AS IDENTITY
```

- Тип данных может быть `SMALLINT`, `INT` или `BIGINT`
- `GENERATED ALWAYS` — не позволит добавлять значение самостоятельно
- `GENERATED BY DEFAULT` — позволяет добавлять значения самостоятельно

> - [Documentation](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-PARMS-GENERATED-IDENTITY)
> - [Документация](https://postgrespro.ru/docs/postgrespro/current/sql-createtable#SQL-CREATETABLE-PARMS-GENERATED-IDENTITY)

---

### Добавление записи

```sql
-- Одна запись
INSERT INTO users (id, username, email, birthday, created_at, updated_at)
VALUES (1, 'cgehuzi', 'mail.cgehuzi@gmail.com', '1991-01-01', '2021-01-01', '2021-01-01');

-- Несколько записей
INSERT INTO users (id, username, email, birthday, created_at, updated_at)
VALUES
(1, 'user1', 'user1@mail.com', '1991-01-01', '2021-01-01', '2021-01-01'),
(2, 'user2', 'user2@mail.com', '1992-01-01', '2021-01-01', '2021-01-01'),
(3, 'user3', 'user3@mail.com', '1993-01-01', '2021-01-01', '2021-01-01');
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-insert.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-insert)

---

### Редактирование записи

```sql
UPDATE users
SET email = 'new.cgehuzi@gmail.com'
WHERE username = 'cgehuzi';
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-update.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-update)

---

### Получение данных

```sql
-- Все колонки
SELECT * FROM users;
SELECT * FROM users WHERE username = 'cgehuzi';

-- Определенные колонки
SELECT id, email FROM users;
SELECT id, email FROM users WHERE username = 'cgehuzi';
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-select.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-select)

---

### Удаление записи

```sql
DELETE FROM users
WHERE username = 'cgehuzi';
```

> - [Documentation](https://www.postgresql.org/docs/current/sql-delete.html)
> - [Документация](https://postgrespro.ru/docs/postgresql/current/sql-delete)
